<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">
<head>
    <title>–ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥ - –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∏–¥–µ–π</title>
</head>
<body>
<div layout:fragment="content">
    <div class="container py-4">
        <h1 class="mb-4">üë• –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∫–æ–º–∞–Ω–¥</h1>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è -->
        <ul class="nav nav-tabs mb-4">
            <li class="nav-item">
                <a class="nav-link" th:href="@{/manager}">–û–±–∑–æ—Ä</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/manager/people}">–õ—é–¥–∏</a>
            </li>
            <li class="nav-item">
                <a class="nav-link active" th:href="@{/manager/teams}">–ö–æ–º–∞–Ω–¥—ã</a>
            </li>
            <li class="nav-item">
                <a class="nav-link" th:href="@{/manager/funnel}">–í–æ—Ä–æ–Ω–∫–∞</a>
            </li>
        </ul>

        <!-- –°–≤–æ–¥–∫–∞ -->
        <div class="row mb-4">
            <div class="col-md-3">
                <div class="card border-primary">
                    <div class="card-body text-center">
                        <h3 class="text-primary" th:text="${#lists.size(teams)}">0</h3>
                        <p class="mb-0">–í—Å–µ–≥–æ –∫–æ–º–∞–Ω–¥</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-success">
                    <div class="card-body text-center">
                        <h3 class="text-success" th:text="${teams.?[ideasCount > 0].size()}">0</h3>
                        <p class="mb-0">–° –∏–¥–µ—è–º–∏</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-warning">
                    <div class="card-body text-center">
                        <h3 class="text-warning" th:text="${teams.?[engagementRate > 50].size()}">0</h3>
                        <p class="mb-0">–í—ã—Å–æ–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å (&gt;50%)</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="card border-danger">
                    <div class="card-body text-center">
                        <h3 class="text-danger" th:text="${teams.?[ideasCount == 0].size()}">0</h3>
                        <p class="mb-0">–ë–µ–∑ –∏–¥–µ–π</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –õ–µ–≥–µ–Ω–¥–∞ -->
        <div class="alert alert-light mb-4">
            <strong>–í–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å</strong> = –ê–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ / –í—Å–µ–≥–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ √ó 100%
            <span class="ms-3">
                <span class="badge bg-success">‚ñ≤ &gt;50%</span>
                <span class="badge bg-warning text-dark">‚óè 20-50%</span>
                <span class="badge bg-danger">‚ñº &lt;20%</span>
            </span>
        </div>

        <!-- –¢–∞–±–ª–∏—Ü–∞ –∫–æ–º–∞–Ω–¥ -->
        <div class="card">
            <div class="card-body p-0">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                    <tr>
                        <th>–ö–æ–º–∞–Ω–¥–∞</th>
                        <th>–¢—Ä–∞–π–±</th>
                        <th>–î–∏–≤–∏–∑–∏–æ–Ω</th>
                        <th class="text-center">–£—á–∞—Å—Ç–Ω–∏–∫–æ–≤</th>
                        <th class="text-center">–ê–∫—Ç–∏–≤–Ω—ã—Ö</th>
                        <th class="text-center">–ò–¥–µ–π</th>
                        <th class="text-center">–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ</th>
                        <th class="text-center">–í–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr th:each="team : ${teams}"
                        th:class="${team.ideasCount == 0 ? 'table-light' : ''}">
                        <td>
                            <strong th:text="${team.teamName}">–ö–æ–º–∞–Ω–¥–∞</strong>
                        </td>
                        <td th:text="${team.tribeName ?: '‚Äî'}">–¢—Ä–∞–π–±</td>
                        <td th:text="${team.divisionName ?: '‚Äî'}">–î–∏–≤–∏–∑–∏–æ–Ω</td>
                        <td class="text-center" th:text="${team.membersCount}">0</td>
                        <td class="text-center">
                            <span th:if="${team.activeUsersCount > 0}" class="fw-bold text-success"
                                  th:text="${team.activeUsersCount}">0</span>
                            <span th:if="${team.activeUsersCount == 0}" class="text-muted">0</span>
                        </td>
                        <td class="text-center">
                            <span th:if="${team.ideasCount > 0}" class="fw-bold"
                                  th:text="${team.ideasCount}">0</span>
                            <span th:if="${team.ideasCount == 0}" class="text-muted">0</span>
                        </td>
                        <td class="text-center">
                            <span th:if="${team.implementedCount > 0}" class="badge bg-success"
                                  th:text="${team.implementedCount}">0</span>
                            <span th:if="${team.implementedCount == 0}" class="text-muted">0</span>
                        </td>
                        <td class="text-center">
                            <div class="d-flex align-items-center justify-content-center">
                                <div class="progress flex-grow-1 me-2" style="height: 8px; max-width: 60px;">
                                    <div class="progress-bar"
                                         th:classappend="${team.engagementRate > 50 ? 'bg-success' : (team.engagementRate > 20 ? 'bg-warning' : 'bg-danger')}"
                                         th:style="'width: ' + ${team.engagementRate} + '%'"></div>
                                </div>
                                <span th:class="${team.engagementRate > 50 ? 'text-success' : (team.engagementRate > 20 ? 'text-warning' : 'text-danger')}"
                                      th:text="${#numbers.formatDecimal(team.engagementRate, 1, 0)} + '%'">0%</span>
                            </div>
                        </td>
                        <td>
                            <span th:if="${team.ideasCount >= 5 && team.engagementRate > 50}"
                                  class="badge bg-success">üåü –õ–∏–¥–µ—Ä</span>
                            <span th:if="${team.ideasCount > 0 && team.ideasCount < 5 && team.engagementRate > 20}"
                                  class="badge bg-info">üìà –†–∞—Å—Ç—ë—Ç</span>
                            <span th:if="${team.ideasCount > 0 && team.engagementRate <= 20}"
                                  class="badge bg-warning text-dark">‚ö†Ô∏è –ü–æ—Ç–µ–Ω—Ü–∏–∞–ª</span>
                            <span th:if="${team.ideasCount == 0 && team.membersCount > 0}"
                                  class="badge bg-secondary">üí§ –°–ø—è—â–∞—è</span>
                            <span th:if="${team.membersCount == 0}"
                                  class="badge bg-dark">‚àÖ –ü—É—Å—Ç–∞—è</span>
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –ü–æ–¥—Å–∫–∞–∑–∫–∞ -->
        <div class="mt-4 text-muted small">
            <strong>–°—Ç–∞—Ç—É—Å—ã –∫–æ–º–∞–Ω–¥:</strong><br>
            üåü <strong>–õ–∏–¥–µ—Ä</strong> ‚Äî ‚â•5 –∏–¥–µ–π –∏ –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å &gt;50%<br>
            üìà <strong>–†–∞—Å—Ç—ë—Ç</strong> ‚Äî –ï—Å—Ç—å –∏–¥–µ–∏, –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å &gt;20%<br>
            ‚ö†Ô∏è <strong>–ü–æ—Ç–µ–Ω—Ü–∏–∞–ª</strong> ‚Äî –ï—Å—Ç—å –∏–¥–µ–∏, –Ω–æ –Ω–∏–∑–∫–∞—è –≤–æ–≤–ª–µ—á—ë–Ω–Ω–æ—Å—Ç—å<br>
            üí§ <strong>–°–ø—è—â–∞—è</strong> ‚Äî –ù–µ—Ç –∏–¥–µ–π, –Ω–æ –µ—Å—Ç—å —É—á–∞—Å—Ç–Ω–∏–∫–∏<br>
            ‚àÖ <strong>–ü—É—Å—Ç–∞—è</strong> ‚Äî –ù–µ—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
        </div>
    </div>
</div>
</body>
</html>
